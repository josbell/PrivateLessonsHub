const google = require('googleapis');
const OAuth2 = google.auth.OAuth2;
const googleAutoOauth2 = require('../')
const randomstring = require("randomstring")

const CLIENT_ID = '102832204801-6k4mvr31m186jgs8eefg3sosks5dov87.apps.googleusercontent.com'
const CLIENT_SECRET = 'RmbkjbHQ3PJHt1I-smIZBy9P'
const REDIRECT_URL = 'urn:ietf:wg:oauth:2.0:oob'

var oauth2Client = new OAuth2(CLIENT_ID, CLIENT_SECRET, REDIRECT_URL);

// generate a url that asks permissions for Google+ and Google Calendar scopes
var scopes = [
  'https://picasaweb.google.com/data/'
];

var url = oauth2Client.generateAuthUrl({
  access_type: 'offline', // 'online' (default) or 'offline' (gets refresh_token)
  scope: scopes // If you only need one scope you can pass it as string
});

console.log(url)

newPassword = randomstring.generate()
console.log('new password:', newPassword)

var params = {
	email: 'ZoeQuinn298@gmail.com',
	password: 'TnG53sVs',
	challenge: {
		phoneNumber: '3016874369',
		email: 'AdrianTaylor729@gmail.com',
		password: newPassword,
	},
	debug: true
}

googleAutoOauth2.options = {
  	openDevTools: true,
		show: true,
		webPreferences:{
			partition: 'nopersist',
		}
	}
	
googleAutoOauth2.getCode(url, params, 100000).then((code, newPassword) => {
	console.log(code)
	console.log(newPassword)
	oauth2Client.getToken(code, function(err, tokens) {
	  if(!err) {
	    console.log(tokens);
	  }
	})
}).catch((error) => console.log(error))
